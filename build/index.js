!function r(s,a,u){function l(e,t){if(!a[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(h)return h(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[e]={exports:{}};s[e][0].call(o.exports,function(t){return l(s[e][1][t]||t)},o,o.exports,r,s,a,u)}return a[e].exports}for(var h="function"==typeof require&&require,t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,n){"use strict";function i(t){this.id=t,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}(e.exports=i).prototype.setVolume=function(t,e){var n=this.muted;this.muted=0===t||e||!1,null!=t?this.volume=t:t=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,t*this.loopVol))),n&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},i.prototype.setMute=function(t){this.setVolume(null,t)},i.prototype.playLoopSound=function(t,n,i,o,r,s){var a=this.audioManager,u=a.settings.defaultFade,e=a.settings.crossFading,l=this.loopSound,h=l&&l.id;if(n=Math.max(0,Math.min(1,n||1)),this.loopId=t,this.loopVol=n,!a.muted&&!this.muted){if(t===h&&l)return l.play(n*this.volume,i,o),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(l=null,!this.nextLoop||this.nextLoop.id!==t){var c=this;e?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=a.createSound(t,this.id),this.nextLoop.load(function(t){if(t)return c.nextLoop.unload(),void(c.nextLoop=null);p(c.loopSound),d()})):(this.nextLoop=a.createSound(t,this.id),p(this.loopSound,d))}}function p(t,e){if(!t)return e&&e();t.stopping||t.stop(function(){return a.freeSound(t),t=null,e&&e()})}function f(){var e=c.loopSound=c.nextLoop;c.nextLoop=null,e&&(e.setLoop(!0,r,s),e.fade=u,e.load(function(t){if(t)return e.unload(),void(c.loopSound=null);e.play(n*c.volume,i,o)}))}function d(){c.loopSound=null,window.setTimeout(f,0)}}},{}],2:[function(t,e,n){"use strict";var i=window.AudioContext||window.webkitAudioContext,o=t("./OrderedList"),r=t("./SoundBuffered.js"),s=t("./SoundGroup.js"),a=t("./AudioChannel.js"),u=t("./ISound.js");function l(t){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new o(function(){return 1}),this.soundGroupArchive=new o(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(t,e){return t+e+".mp3"},getSoundConstructor:function(){return null}};for(var e=0;e<t.length;e++){var n=t[e];this.channels[n]=new a(n)}u.prototype.audioManager=this,s.prototype.audioManager=this,a.prototype.audioManager=this}i||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),r=t("./Sound.js"),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),r=u)),e.exports=l,e.exports.ISound=u,l.prototype.init=function(){if(!this.audioContext&&i)for(var t in this.audioContext=new i,r.prototype.audioContext=this.audioContext,this.soundsById)this.soundsById[t].init()},l.prototype.getEmptySound=function(t,e){var n,i=this.settings.getSoundConstructor(t,e);return i?n=new i:(0<this.freeSoundPool.length?(n=this.freeSoundPool.pop()).init():n=new r,n)},l.prototype.setup=function(t){for(var e in t){var n=t[e];this.setVolume(e,n.volume,n.muted)}},l.prototype.addChannel=function(t){this.channels[t]||(this.channels[t]=new a(t))},l.prototype.setVolume=function(t,e,n){var i=this.channels[t];i&&i.setVolume(e,n)},l.prototype.setMute=function(t){for(var e in void 0===t&&(t=!this.muted),this.muted=!!t,this.channels){var n=this.channels[e];if(n.loopSound)if(t)n.loopSound.stop();else{var i=n.muted;n.muted=!0,n.setVolume(null,i)}}},l.prototype.loadSound=function(t,e){var n=this.createSound(t);return n.load(e),n},l.prototype.createSound=function(t,e){var n=this.getSound(t);return n||((n=this.soundsById[t]=this.getEmptySound(e,t)).setId(t),n)},l.prototype.createSoundPermanent=function(t,e){var n=this.getSound(t);if(n)return n;var i=this.settings.getSoundConstructor(e,t)||r;return(n=this.permanentSounds[t]=new i).setId(t),n},l.prototype.getSound=function(t){var e=this.permanentSounds[t];return e||((e=this.soundsById[t])?e:(e=this.soundArchiveById[t])?(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t],this.soundsById[t]=e):null)},l.prototype.getSoundGroup=function(t){var e=this.soundGroupsById[t];return e||((e=this.soundGroupArchiveById[t])?(this.soundGroupArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundGroupArchiveById[t],e.verifySounds(),this.soundGroupsById[t]=e):null)},l.prototype.freeSound=function(t){var e=t.id;this.soundsById[e]&&delete this.soundsById[e],this.soundArchiveById[e]&&(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e]),t.unload(),t instanceof r&&this.freeSoundPool.push(t)},l.prototype.playLoopSound=function(t,e,n,i,o,r,s){var a=this.channels[t];if(!a)return console.warn('Channel id "'+t+'" does not exist.');a.playLoopSound(e,n,i,o,r,s)},l.prototype.stopLoopSound=function(t){var e=this,n=this.channels[t];if(!n)return console.warn('Channel id "'+t+'" does not exist.');var i=n.loopSound;n.loopId=null,i&&i.stop(function(){e.freeSound(i),n.loopSound=null})},l.prototype.stopAllLoopSounds=function(){for(var t in this.channels)this.stopLoopSound(t)},l.prototype.release=function(){var t,e,n,i=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,r={};for(t in this.channels){var s=this.channels[t];s.loopSound&&(r[s.loopSound.id]=!0)}for(t in this.soundGroupsById)(e=this.soundGroupsById[t]).poolRef=this.soundGroupArchive.add(e),this.soundGroupArchiveById[t]=e,delete this.soundGroupsById[t];for(t in this.soundsById)r[t]||((n=this.soundsById[t]).poolRef=this.soundArchive.add(n),this.soundArchiveById[t]=n,delete this.soundsById[t]);for(var a=this.soundGroupArchive.getCount();i<a&&(e=this.soundGroupArchive.popFirst());)e.poolRef=null,delete this.soundGroupArchiveById[e.id],--a;for(;this.usedMemory>o&&(n=this.soundArchive.popFirst());)n.poolRef=null,delete this.soundArchiveById[n.id],this.freeSound(n)},l.prototype.playSound=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(!r.muted){var s=this.getSound(e);n=n||1,(s=s||this.createSound(e,t)).play(r.volume*n,i,o)}}},l.prototype.playSoundGroup=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(r&&!r.muted){var s=this.getSoundGroup(e);if(!s)return console.warn('SoundGroup "'+e+'" does not exist.');n=n||1,s.play(n*r.volume,i,o)}}},l.prototype.createSoundGroup=function(t,e,n){if(!this.getSoundGroup(t)){var i=new s(t,e.id,e.vol,e.pitch,n);this.soundGroupsById[t]=i}},l.prototype.createSoundGroups=function(t,e){var n=void 0!==e&&this.channels[e].muted;for(var i in t)this.createSoundGroup(i,t[i],n)}},{"./AudioChannel.js":1,"./ISound.js":3,"./OrderedList":4,"./Sound.js":5,"./SoundBuffered.js":6,"./SoundGroup.js":7}],3:[function(t,e,n){"use strict";function i(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}(e.exports=i).prototype.setId=function(t){this.id=t,this._loaded=!1},i.prototype.load=function(t){return this.id?this._loaded?t&&t(null,this):(t&&this._onLoadQueuedCallback.push(t),this._loading?void 0:(this._loading=!0,this._load())):t&&t("noId")},i.prototype._finalizeLoad=function(t){var e=this.audioManager.settings.maxPlayLatency;this._loaded=!t,this._loading=!1;for(var n=0;n<this._onLoadQueuedCallback.length;n++)this._onLoadQueuedCallback[n](t,this);if(this._onLoadQueuedCallback=[],this._unloading)return this._unloading=!1,void this.unload();this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<e)&&this._play(),this._playTriggered=0)},i.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},i.prototype.play=function(t,e,n){if(null!=t&&this.setVolume(t),null!=e&&this.setPan(e),!this._loaded)return this._playTriggered=Date.now(),void this.load();this.loop&&this.playing?this._updatePlayPitch(n):this._play(n)},i.prototype.init=function(){},i.prototype.setVolume=function(t){this.volume=t},i.prototype.setPan=function(t){this.pan=t},i.prototype.setLoop=function(t){this.loop=t},i.prototype.setPitch=function(t){this.pitch=t},i.prototype._updatePlayPitch=function(t){},i.prototype._play=function(t){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},i.prototype.stop=function(t){return this.playing=!1,t&&t()},i.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},i.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?!(this._unloading=!0):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,!(this.usedMemory=0))}},{}],4:[function(t,e,n){"use strict";function r(t,e,n,i){this.object=t,this.previous=e,this.next=n,this.container=i}function i(t){this.count=0,this.first=null,this.last=null,this.cmpFunc=t}i.prototype.add=function(t){var e=new r(t,null,null,this);if(this.count+=1,null===this.first)return this.first=e,this.last=e;var n=this.cmpFunc(t,this.first.object);if(n<0)return e.next=this.first,this.first.previous=e,this.first=e;var i,o=this.cmpFunc(t,this.last.object);if(0<=o)return e.previous=this.last,this.last.next=e,this.last=e;if(n+o<0){for(i=this.first.next;0<=this.cmpFunc(t,i.object);)i=i.next;e.next=i,e.previous=i.previous,e.previous.next=e,i.previous=e}else{for(i=this.last.previous;this.cmpFunc(t,i.object)<0;)i=i.previous;e.previous=i,e.next=i.next,e.next.previous=e,i.next=e}return e},i.prototype.removeByRef=function(t){return!(!t||t.container!==this)&&(--this.count,null===t.previous?this.first=t.next:t.previous.next=t.next,null===t.next?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=null,!(t.container=null))},i.prototype.moveToTheBeginning=function(t){return!(!t||t.container!==this)&&(null===t.previous||(t.previous.next=t.next,this.last===t?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=this.first,t.next.previous=t,this.first=t),!0)},i.prototype.moveToTheEnd=function(t){return!(!t||t.container!==this)&&(null===t.next||(t.next.previous=t.previous,this.first===t?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=this.last,t.previous.next=t,this.last=t),!0)},i.prototype.possess=function(t){return t&&t.container===this},i.prototype.popFirst=function(){var t=this.first;if(!t)return null;--this.count;var e=t.object;return this.first=t.next,null!==this.first&&(this.first.previous=null),t.next=null,t.container=null,e},i.prototype.popLast=function(){var t=this.last;if(!t)return null;--this.count;var e=t.object;return this.last=t.previous,null!==this.last&&(this.last.next=null),t.previous=null,t.container=null,e},i.prototype.getFirst=function(){return this.first&&this.first.object},i.prototype.getLast=function(){return this.last&&this.last.object},i.prototype.clear=function(){for(var t=this.first;t;t=t.next)t.container=null;this.count=0,this.first=null,this.last=null},i.prototype.getCount=function(){return this.count},i.prototype.forEach=function(t,e){for(var n=this.first;n;n=n.next)t(n.object,e)},i.prototype.forEachReverse=function(t,e){for(var n=this.last;n;n=n.previous)t(n.object,e)},i.prototype.reposition=function(t){if(t.container!==this)return this.add(t.object);var e=t.previous,n=t.next,i=t.object;for(null===n?this.last=e:n.previous=e,null===e?this.first=n:e.next=n;null!==e&&this.cmpFunc(i,e.object)<0;)e=(n=e).previous;for(;null!==n&&0<=this.cmpFunc(i,n.object);)n=(e=n).next;return null===(t.next=n)?this.last=t:n.previous=t,null===(t.previous=e)?this.first=t:e.next=t,t},e.exports=i},{}],5:[function(t,e,n){"use strict";var i=t("util").inherits,o=t("./ISound.js"),r={playAudioWhenScreenIsLocked:!1};function s(){o.call(this);var t=new Audio;t.loop=!1,t.type="audio/mpeg",this._audio=t,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.audioContext.destination))}i(s,o),(e.exports=s).prototype.setVolume=function(t){this.volume=this._audio.volume=t},s.prototype.setLoop=function(t){this.loop=this._audio.loop=t},s.prototype._load=function(){var e=this;function n(t){e._finalizeLoad(t)}function i(){this.removeEventListener("canplaythrough",i),this.removeEventListener("error",o),e.usedMemory=this.duration,e.audioManager.usedMemory+=this.duration,e._finalizeLoad(null)}function o(t){this.removeEventListener("canplaythrough",i),this.removeEventListener("error",o),n(t)}function r(t){e._loading=!0,e._audio.addEventListener("canplaythrough",i),e._audio.addEventListener("error",o),e._audio.src=t,e._audio.load()}var t=this.audioManager.settings.getFileUri,s=this.audioManager.settings.audioPath;if(2<t.length)t(s,this.id,function(t,e){if(t)return n(t);r(e)});else try{var a=t(s,this.id);if(!a)return n("emptyUri");r(a)}catch(t){n(t)}},s.prototype.unload=function(){o.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},s.prototype._play=function(t){this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(r),this.playing=!0},s.prototype.stop=function(t){return this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,t&&t()}},{"./ISound.js":3,util:39}],6:[function(t,e,n){"use strict";var i=t("util").inherits,o=t("./ISound.js"),r=1e-6;function s(){o.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this._loopStart=0,this._loopEnd=0,this.init()}i(s,o),(e.exports=s).prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var t,e=this.audioContext,n=e.createGain();t=e.createStereoPanner?e.createStereoPanner():e.createPanner(),n.connect(t),t.connect(e.destination),n.gain.value=0,this.sourceConnector=n,this.gain=n.gain,this.panNode=t,this._audioNodeReady=!0}},s.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var t=this.audioContext,e=this.panNode,n=this.sourceConnector;n.disconnect(e),e.disconnect(t.destination),this.source&&(this.source.disconnect(n),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},s.prototype.init=function(){if(this._createAudioNodes(),this.rawAudioData){var e=this,n=this.audioManager.settings.maxPlayLatency;this.audioContext.decodeAudioData(this.rawAudioData,function(t){e.buffer=t,e.usedMemory=t.duration,e.audioManager.usedMemory+=t.duration,e.rawAudioData=null,e._loaded&&e._playTriggered&&((e.loop||Date.now()-e._playTriggered<n)&&e._play(),e._playTriggered=0)},function(){console.error("decode audio failed for sound ",e.id)})}},s.prototype.setVolume=function(t){if(this.volume=t,this.playing)if(this.fade){t<=0&&(t=r);var e=this.audioContext.currentTime;this.gain.cancelScheduledValues(e),this.gain.setValueAtTime(this.gain.value||r,e),this.gain.linearRampToValueAtTime(t,e+this.fade)}else this.gain.value=t},s.prototype.setPan=function(t){this.pan=t,this.panNode&&(this.panNode.pan?this.panNode.pan.value=t:this.panNode.setPosition(t,0,.2))},s.prototype.setLoop=function(t,e,n){this.loop=!!t,this._loopStart=e||0,this._loopEnd=n||0,this.source&&this.buffer&&(this.source.loop=t,this._setLoopPoints())},s.prototype._setLoopPoints=function(){this.source.loopStart=this._loopStart||0;var t=this._loopEnd;t<0&&(t=this.buffer.duration+t),t<0&&(t=0),this.source.loopEnd=t||this.buffer.duration},s.prototype.setPitch=function(t,e){this.pitch=t,this._setPlaybackRate(e)},s.prototype._updatePlayPitch=function(t){!t&&0!==t||t===this._playPitch||(this._playPitch=t,this._setPlaybackRate(0))},s.prototype._setPlaybackRate=function(t){if(this.source){var e=Math.pow(2,(this._playPitch+this.pitch)/12);if(t){var n=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(n),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||r,n),this.source.playbackRate.linearRampToValueAtTime(e,n+t)}else this.source.playbackRate.value=e}},s.prototype._load=function(){var n=this;function i(t){n._finalizeLoad(t)}function o(t){n.buffer=t,n.usedMemory=t.duration,n.audioManager.usedMemory+=t.duration,n._finalizeLoad(null)}function r(t){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=function(){if(4==~~e.readyState)return 200!=~~e.status&&0!=~~e.status?i("xhrError:"+e.status):void(n.audioContext?n.audioContext.decodeAudioData(e.response,o,i):(n.rawAudioData=e.response,n._finalizeLoad(null)))},e.open("GET",t,!0),e.send()}this._createAudioNodes();var t=this.audioManager.settings.getFileUri,e=this.audioManager.settings.audioPath;if(2<t.length)t(e,this.id,function(t,e){if(t)return i(t);r(e)});else try{var s=t(e,this.id);if(!s)return i("emptyUri");r(s)}catch(t){i(t)}},s.prototype.unload=function(){o.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},s.prototype._play=function(t){if(this.buffer){this.playing=!0;var e=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(e),this.fade?(this.gain.setValueAtTime(this.gain.value||r,e),this.gain.linearRampToValueAtTime(this.volume||r,e+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var n=this.source=this.audioContext.createBufferSource();n.connect(this.sourceConnector);var i=this;n.onended=function(){i.playing=!1,n.onended=null,i.source=null},this._playPitch=t||0,(t||this.pitch)&&this._setPlaybackRate(0),n.loop=this.loop,n.buffer=this.buffer,this._setLoopPoints(),n.start(0)}else this._playTriggered=Date.now()},s.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},s.prototype.stop=function(t){if(!this.playing&&!this.stopping)return t&&t();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return t&&t();if(this._onStopCallback=t,!this._fadeTimeout){if(this.fade){var e=this,n=this.audioContext.currentTime;return this.gain.cancelScheduledValues(n),this.gain.setValueAtTime(this.gain.value||r,n),this.gain.linearRampToValueAtTime(r,n+this.fade),void(this._fadeTimeout=window.setTimeout(function(){e._fadeTimeout=null,e._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},{"./ISound.js":3,util:39}],7:[function(t,e,n){"use strict";function i(t,e,n,i,o){this.id=t,this.soundIds=e,this.volumes=n||[],this.pitches=i||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),o||this._createSounds()}(e.exports=i).prototype._createSounds=function(){for(var t=this.soundIds,e=0;e<t.length;e++)this.audioManager.loadSound(t[e]);this._ready=!0},i.prototype.play=function(t,e,n){if(0!==this.soundIds.length){this._ready||this._createSounds();var i=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(i);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+i+"  cannot be played.");t=t||1,n=n||0,t*=this.volumes[this.volIndex++],n+=this.pitches[this.pitchIndex++],o.play(t,e,n),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},i.prototype.verifySounds=function(){for(var t=0;t<this.soundIds.length;t++){var e=this.soundIds[t];this.audioManager.createSound(e)}}},{}],8:[function(t,e,n){"use strict";var s=/rgba?\(\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,?\s*([.0-9]+)?\s*\)/;function i(){this.r=0,this.g=0,this.b=0,this.a=void 0,this.string=""}(e.exports=i).prototype._setRGB=function(t,e,n){this.r=t,this.g=e,this.b=n},i.prototype.fromPixel=function(t,e){var n=t[e+0],i=t[e+1],o=t[e+2];return this.string="rgb("+n+","+i+","+o+")",this._setRGB(n,i,o),this},i.prototype.fromString=function(t){var e,n,i,o=(this.string=t).match(s);if(o)e=~~o[1],n=~~o[2],i=~~o[3],this._setRGB(e,n,i);else{var r="0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&");this._setRGB(r>>16,r>>8&255,255&r)}return this},i.prototype.fromRGB=function(t,e,n){return this._setRGB(t,e,n),this.string="rgb("+t+","+e+","+n+")",this},i.prototype.fromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.string=t.string,this}},{}],9:[function(t,e,n){"use strict";var i=t("./index"),o=t("../domUtils/createCanvas"),l=8,h=8,y=Math.PI/2;i.setTileSize=function(t,e){l=~~t,h=~~e},i.prototype._init=function(){this.canvas=o(this.width,this.height),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle=this.palette[0].string,this.ctx.strokeStyle=this.palette[1].string,this.resize(this.width,this.height)},i.prototype.resize=function(t,e){return this.canvas.width=this.width=t,this.canvas.height=this.height=e,this.clear(),this},i.prototype.sprite=function(t,e,n,i,o,r){var s=l*(t%16),a=h*~~(t/16),u=this.ctx;return e=e||0,n=n||0,e=~~Math.round(e-this.camera.x),n=~~Math.round(n-this.camera.y),i||o||r?(u.save(),i&&(u.scale(-1,1),e=-e-l),o&&(u.scale(1,-1),n=-n-h),r?(u.translate(e+h,n),u.rotate(y)):u.translate(e,n),u.drawImage(this.tilesheet,this.ox+s,this.oy+a,l,h,0,0,l,h),u.restore()):u.drawImage(this.tilesheet,this.ox+s,this.oy+a,l,h,e,n,l,h),this},i.prototype.draw=function(t,e,n,i,o,r){var s=i||o||r;if(t._isSprite){var a=t;t=a.img;var u=a.x,l=a.y,h=a.width,c=a.height,p=~~Math.round((e||0)-this.camera.x),f=~~Math.round((n||0)-this.camera.y);return s?((d=this.ctx).save(),r?(i&&(d.scale(-1,1),p*=-1,p-=c),o&&(d.scale(1,-1),f*=-1,f-=h),d.translate(p+c,f),d.rotate(y)):(i&&(d.scale(-1,1),p*=-1,p-=h),o&&(d.scale(1,-1),f*=-1,f-=c),d.translate(p,f)),d.drawImage(t,u,l,h,c,0,0,h,c),d.restore(),this):(this.ctx.drawImage(t,u,l,h,c,p,f,h,c),this)}t._isTileMap&&(t.texture||t._prepareTexture(),t=t.texture.canvas),t._isTexture&&(t=t.canvas);var d;p=~~Math.round((e||0)-this.camera.x),f=~~Math.round((n||0)-this.camera.y);return s?((d=this.ctx).save(),r?(i&&(d.scale(-1,1),p*=-1,p-=t.height),o&&(d.scale(1,-1),f*=-1,f-=t.width),d.translate(p+t.height,f),d.rotate(y)):(i&&(d.scale(-1,1),p*=-1,p-=t.width),o&&(d.scale(1,-1),f*=-1,f-=t.height),d.translate(p,f)),d.drawImage(t,0,0),d.restore()):this.ctx.drawImage(t,p,f),this},i.prototype.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},i.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this},i.prototype.pen=function(t){return this._pen=t%this.palette.length,this.ctx.strokeStyle=this.palette[this._pen].string,this},i.prototype.paper=function(t){return this._paper=t%this.palette.length,this.ctx.fillStyle=this.palette[this._paper].string,this},i.prototype.rect=function(t,e,n,i){if(n<=1||i<=1){var o=this.ctx.fillStyle;return this.ctx.fillStyle=this.ctx.strokeStyle,this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~n,~~i),this.ctx.fillStyle=o,this}return this.ctx.strokeRect(.5+~~(t-this.camera.x),.5+~~(e-this.camera.y),~~(n-1),~~(i-1)),this},i.prototype.rectf=function(t,e,n,i){return this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~n,~~i),this},i.prototype.rectfill=i.prototype.rectf,i.prototype._isTexture=!0,i.prototype.tilesheet=o(16*l,16*h)},{"../domUtils/createCanvas":15,"./index":10}],10:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.camera={x:0,y:0},this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._init()}function o(t,e){t.ox=0,t.oy=0,e._isImageWrapper&&(e=e.asset),e._isSprite?(t.ox=e.x,t.oy=e.y,t.tilesheet=e.img):e._isMap?(e.texture||e._prepareTexture(),t.tilesheet=e.texture.canvas):e._isTexture?t.tilesheet=e.canvas:(e instanceof Image||e instanceof HTMLCanvasElement)&&(t.tilesheet=e)}(e.exports=i).prototype.palette=[{string:"#000000",r:0,g:0,b:0},{string:"#FFFFFF",r:1,g:1,b:1}],i.prototype.ox=0,i.prototype.oy=0,i.setTileSize=function(){},i.prototype.setPalette=function(t){i.prototype.palette=t},i.prototype.setGlobalTilesheet=function(t){o(i.prototype,t)},i.prototype.setTilesheet=function(t){if(t)return o(this,t),this;delete this.tilesheet},i.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this}},{}],11:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=t("./index.js"),l=3,h=5,o=i.prototype.setPalette;i.prototype.setPalette=function(t){o.call(this,t),i.prototype.textCharset=new i(128*l,h*t.length),function(t,e){for(var n=[219,438,511,14016,14043,14326,14335,28032,28123,28086,28159,32704,32731,32758,32767,128,146,384,402,9344,9362,9600,9618,192,210,448,466,9408,9426,9664,9682,32767,0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845],i=0;i<e.length;i++){t.fillStyle=e[i].string;for(var o=0;o<n.length;o++)for(var r=n[o],s=0;s<15;s++){var a=s%l,u=~~(s/l);1==(r>>s&1)&&t.fillRect(o*l+a,i*h+u,1,1)}}t.fillStyle=e[0].string}(i.prototype.textCharset.ctx,t)};var s=i.prototype.resize;i.prototype.resize=function(t,e){return this._textOffset=1,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textPadding=e-6*this._textLine-this._textOffset,this._cursor.i=0,this._cursor.j=0,s.call(this,t,e),this},i.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.locate(0,0),this},i.prototype.textCharset=new i(128*l,h*i.prototype.palette.length),i.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},i.prototype.print=function(e,t,n){if("object"===r(e))try{e=JSON.stringify(e)}catch(t){e="[Object]"}else"string"!=typeof e&&(e=e.toString());if(void 0!==t){t=~~Math.round(t-this.camera.x),n=~~Math.round(n-this.camera.y);for(var i=0;i<e.length;i++)this.ctx.drawImage(this.textCharset.canvas,l*e.charCodeAt(i),h*this._pen,l,h,t,n,l,h),t+=4;return this}for(i=0;i<e.length;i++){this._cursor.j>=this._textLine&&this.textScroll();var o=e.charCodeAt(i);10!==o&&13!==o?(this.ctx.drawImage(this.textCharset.canvas,l*o,h*this._pen,l,h,4*this._cursor.i,6*this._cursor.j+this._textOffset,l,h),this._cursor.i+=1,this._cursor.i>this._textColumn&&(this._cursor.i=0,this._cursor.j+=1)):(this._cursor.i=0,this._cursor.j+=1)}return this},i.prototype.println=function(t){return this.print(t),this.print("\n"),this},i.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=6,this.ctx.drawImage(this.canvas,0,-t),this.ctx.fillRect(0,this.canvas.height-t-this._textPadding,this.canvas.width,t+this._textPadding),this}},{"./index.js":10}],12:[function(t,e,n){"use strict";var i=t("../Texture"),o=t(".."),l=8,h=8;function c(t,e,n,i,o,r,s,a){this.x=~~t,this.y=~~e,this.sprite=~~n,this.flipH=!!i,this.flipV=!!o,this.flipR=!!r,this.flagA=!!s,this.flagB=!!a}function r(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=null,this.tilesheet=null,this._tilesheetPath="",t&&e&&this._init(t,e)}(e.exports=r).prototype._isTileMap=!0;var a,f,s={},u=[];r.getMap=function(t){return"string"==typeof t?s[t]:"number"==typeof t?u[t]:(console.error("Map does not exist",t),null)},r._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.warn("Map bank format incorrect"),{_type:"maps",maps:[]}):t:{_type:"maps",maps:[]}},r.loadBank=function(t){t=r._checkBankFormat(t),s={},u=[];for(var e=t.maps||[],n=0;n<e.length;n++)u.push((new r).load(e[n]))},r.setTileSize=function(t,e){l=~~t,h=~~e},Object.defineProperty(r.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&s[this._name]&&s[this._name]===this&&delete s[this._name],(this._name=t)&&!s[t]&&(s[t]=this)}}),r.prototype._init=function(t,e){this.width=t,this.height=e,this.items=[];for(var n=0;n<t;n++){this.items.push([]);for(var i=0;i<e;i++)this.items[n][i]=null}this.texture&&this.texture.resize(t*l,e*h)},r.prototype.resize=function(t,e){var n=this.items,i=Math.min(this.width,t),o=Math.min(this.height,e);this._init(t,e);for(var r=0;r<i;r++)for(var s=0;s<o;s++)this.items[r][s]=n[r][s];return this.redraw(),this},r.prototype.set=function(t,e,n,i,o,r,s,a){if(null==n)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var u=this.items[t][e]=new c(t,e,n,i,o,r,s,a);return this.texture&&(this.texture.ctx.clearRect(t*l,e*h,l,h),this.texture.sprite(u.sprite,u.x*l,u.y*h,u.flipH,u.flipV,u.flipR)),this}},r.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture&&this.texture.ctx.clearRect(t*l,e*h,l,h),this},r.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},r.prototype.redraw=function(){if(!this.texture)return this;this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var n=this.items[t][e];n&&this.texture.sprite(n.sprite,n.x*l,n.y*h,n.flipH,n.flipV,n.flipR)}return this},r.prototype._prepareTexture=function(){this.texture=new i(this.width*l,this.height*h),this.texture.setTilesheet(this.tilesheet),this.redraw()},r.prototype.release=function(){this.texture=null},r.prototype.draw=function(t,e){this.texture||this._prepareTexture(),draw(this.texture,t,e)},r.prototype.setTilesheet=function(t){return this.tilesheet=t,this._tilesheetPath=t&&t.path||"",this.texture&&(this.texture.setTilesheet(t),this.redraw()),this},r.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();for(var e=t.split("/"),n=o.assets||{},i=0;i<e.length;i++)if(!(n=n[e[i]]))return console.warn("Could not find tilesheet",t);this.setTilesheet(n)},function(){for(var n="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",l={},t=0;t<n.length;t++)l[n[t]]=t;var h=n.length,c=h*h-1,p=Math.pow(2,13),r=c-p-1;function s(t){var e=t%h;return n[~~(t/h)]+n[e]}a=function(t){for(var e="",n=0,i=0;i<t.length;i++){var o=t[i];o===t[i+1]&&++n<r||(null===o&&(o=c),e+=s(o),n===r&&n--,0!==n&&(e+=s(p+n)),n=0)}return n===r&&n--,0!==n&&(e+=s(p+n)),e},f=function(t){for(var e=[],n=0;n<t.length;){var i=t[n++],o=t[n++],r=l[i]*h+l[o];if(r===c)e.push(null);else if(p<r)for(var s=r-p,a=e[e.length-1],u=0;u<s;u++)e.push(a);else e.push(r)}return e}}(),r.prototype.save=function(){for(var t=this.width,e=this.height,n=new Array(t*e),i=0;i<t;i++)for(var o=0;o<e;o++){var r=this.items[i][o];n[i+o*t]=r?r.sprite+(r.flipH<<8)+(r.flipV<<9)+(r.flipR<<10)+(r.flagA<<11)+(r.flagB<<12):null}return{w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:a(n)}},r.prototype.load=function(t){this.texture=null;var e=t.w,n=t.h;this._init(e,n),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var i=f(t.data),o=0;o<e;o++)for(var r=0;r<n;r++){var s=i[o+r*e];if(null!==s){var a=255&s,u=s>>8&1,l=s>>9&1,h=s>>10&1,c=s>>11&1,p=s>>12&1;this.set(o,r,a,u,l,h,c,p)}}return this},r.prototype.copy=function(t,e,n,i){t=t||0,e=e||0,null==n&&(n=this.width),null==i&&(i=this.height);var o=new r(n,i);return o.paste(this,-t,-e),o},r.prototype.paste=function(t,e,n,i){e=e||0,n=n||0;for(var o=Math.min(t.width,this.width-e),r=Math.min(t.height,this.height-n),s=Math.max(0,-e),a=Math.max(0,-n),u=s;u<o;u++)for(var l=a;l<r;l++){var h=t.items[u][l];if(h)this.set(u+e,l+n,h.sprite,h.flipH,h.flipV,h.flipR,h.flagA,h.flagB);else{if(i)continue;this.remove(u+e,l+n)}}return this},r.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture&&this.texture.clear(),this},r.prototype.find=function(t,e,n){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===n&&(n=null);for(var i=[],o=0;o<this.width;o++)for(var r=0;r<this.height;r++){var s=this.items[o][r];if(s){var a=null===e||s.flagA===e,u=null===n||s.flagB===n;s.sprite===t&&a&&u&&i.push(s)}}return i},r.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var n=0;n<this.height;n++)null===this.items[e][n]&&t.push({x:e,y:n});return t}},{"..":17,"../Texture":10}],13:[function(t,e,n){"use strict";function f(t,e){var n=new Image;n.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},n.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},n.src=t}function d(t,e){var n=new Audio;function i(){e&&e(null,n),n.removeEventListener("canplaythrough",i),n.removeEventListener("error",o)}function o(){e&&e("snd:load"),n.removeEventListener("canplaythrough",i),n.removeEventListener("error",o)}n.preload=!0,n.loop=!1,n.addEventListener("canplaythrough",i),n.addEventListener("error",o),n.src=t,n.load()}n.loadData=function(t,e,n){var i=new XMLHttpRequest;i.responseType=e||"arraybuffer",i.onreadystatechange=function(){if(4==~~i.readyState)return 200!=~~i.status&&0!=~~i.status?n&&n("xhrError:"+i.status):n&&n(null,i.response)},i.open("GET",t,!0),i.send()},n.loadJson=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==~~n.readyState)return 200!=~~n.status?e("xhrError:"+n.status):e&&e(null,JSON.parse(n.response))},n.open("GET",t,!0),n.send()},n.loadImage=f,n.loadSound=d,n.preloadStaticAssets=function(i,o,r){var a=i.dat,s=i.img.length,u=s+i.snd.length,l=i.root,h=0,c=0;function p(){var n,t,e=h+c;r&&r(h,e,u,e/u),t=e<s?(n=i.img[e],f):(n=i.snd[e-s],d),c+=1,t(l+n,function(t,e){t||function(t,e){var n=t.split("/"),i=n.pop().split(".");i.pop(),i=i.join(".");for(var o=a,r=0,s=n.length;r<s;r++)o=o[n[r]];o[i]=e,n.push(i),e.name=i,e.path=n.join("/")}(n,e),(h+=1)+--c<u?p():0===c&&o(null,a)})}if(0===u)return o(null,a);for(var t=Math.min(5,u-1),e=0;e<=t;e++)p()}},{}],14:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,o;i=window,o=function(){return i={},o.m=n=[function(t,e,n){var o=n(4);function i(){this.name="",this.speed=20,this.pmin=0,this.pmax=127,this.snap=!1,this.steps=[],this.audio=null}(t.exports=i).prototype.serialize=function(){for(var t="",e=0;e<this.steps.length;e++)t+=this.steps[e].serialize();return{n:this.name,i:[this.speed,this.pmin,this.pmax,~~this.snap],s:t}},i.prototype.deserialize=function(t){this.name=t.n,this.speed=t.i[0],this.pmin=t.i[1],this.pmax=t.i[2],this.snap=!!t.i[3],this.audio=null,this.steps=[];for(var e=t.s,n=0;n<e.length;n+=3){var i=new o;i.deserialize(e,n),this.steps.push(i)}return this},i.prototype.check=function(){11<this.name.length&&(this.name=this.name.substr(0,11)),this.speed=Math.max(0,Math.min(53,~~this.speed)),this.pmin=Math.max(0,Math.min(101,~~this.pmin)),this.pmax=Math.max(26,Math.min(127,~~this.pmax));for(var t=0;t<this.steps.length;t++)this.steps[t].check()}},function(t,e){e.SAMPLE_RATE=44100,e.CHUNK_LENGTH=50},function(t,e,n){var i=n(3),o=n(0),r=new(n(6)),s=audioManager.getEmptySound().__proto__.constructor;if(!s.prototype._createAudioNodes)throw new Error("webAudio required");function a(t){s.call(this),this._data=t}function u(t){var e=new a(t);return t.audio=e}inherits(a,s),a.prototype.load=function(t){if(this._loaded)return t&&t(null,this);t&&this._onLoadQueuedCallback.push(t),this.buffer=r.generateSound(this._data),this.usedMemory=this.buffer.duration,this.audioManager.usedMemory+=this.buffer.duration,this._finalizeLoad(null)},o.prototype.play=function(t,e,n){this.audio?this.audio.play(t,e,n):u(this).play(t,e,n)};var l=new i,h=[];e.loadProgram=function(t){l.deserialize(t),assets.bleeper={};for(var e=h.length=0;e<l.sounds.length;e++){var n=l.sounds[e],i=u(n);h.push(i);var o=n.name;o&&(assets.bleeper[o]=i,audioManager.permanentSounds[o]=i)}return l},e.sounds=h},function(t,e,n){var o=n(0);function i(){this.version=1,this.sounds=[]}(t.exports=i).prototype.serialize=function(){for(var t=[],e=0;e<this.sounds.length;e++)t.push(this.sounds[e].serialize());return{_type:"Bleeper program",v:this.version,s:t}},i.prototype.deserialize=function(t){if("Bleeper program"!==t._type)throw new Error("Incorrect data type");this.version=t.v,this.sounds.length=0;for(var e=t.s,n=0;n<e.length;n++){var i=new o;i.deserialize(e[n]),this.sounds.push(i)}return this},i.prototype.check=function(){if(0!==this.sounds.length)for(var t=0;t<this.sounds.length;t++)this.sounds[t].check();else this.sounds.push(new o)}},function(t,e,n){var o=n(5);function i(){this.wave=0,this.pitch=0,this.volume=0}(t.exports=i).prototype.serialize=function(){var t=this.wave,e=this.pitch;return 92<this.pitch&&(t+=8,e-=92),o.encodeUint6(t)+o.encodeUint6(e)+o.encodeUint6(this.volume)},i.prototype.deserialize=function(t,e){var n=o.decodeUint6(t,e),i=o.decodeUint6(t,e+1);return this.volume=o.decodeUint6(t,e+2),8<=n&&(n-=8,i+=92),this.wave=n,this.pitch=i,this},i.prototype.check=function(){this.wave=Math.max(0,Math.min(7,~~this.wave)),this.pitch=Math.max(0,Math.min(93,~~this.pitch)),this.volume=Math.max(0,Math.min(62,~~this.volume))}},function(t,e){for(var n="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",o=n.length,r={},i=0;i<n.length;i++)r[n[i]]=i;e.encodeUint13=function(t){return n[~~(t/o)]+n[t%o]},e.encodeUint6=function(t){return n[t]},e.decodeUint13=function(t,e){var n=t[e],i=t[e+1];return r[n]*o+r[i]},e.decodeUint6=function(t,e){return r[t[e]]}},function(t,e,n){var l=n(7),i=n(8),o=n(1),h=o.SAMPLE_RATE,c=o.CHUNK_LENGTH;function r(){this.oscillator=new i}(t.exports=r).prototype.generateSound=function(t){var e=t.steps;if(0===e.length)return null;var n=(t.speed+1)*c,i=e.length*n+100,o=l.createBuffer(1,i,h),r=o.getChannelData(0);this.oscillator.reset();for(var s=0,a=0;s<e.length;s++){var u=e[s];this.oscillator.setStep(t,u),this.oscillator.generate(r,a,a+n),a+=n}return this.oscillator.generateEndDamping(r,a,a+100),o}},function(t,e){var n=new window.AudioContext;t.exports=n},function(t,e,n){var i=n(9),o=n(1).SAMPLE_RATE,r=2*Math.PI,s=[0,.12,.25,.37,.5,.62,.75,.87,.87,.75,.62,.5,.37,.25,.12,0,-.12,-.25,-.37,-.5,-.62,-.75,-.87,-1,-1,-.87,-.75,-.62,-.5,-.37,-.25,-.12];function a(){this._amp=1,this._oscPos=0,this._oscInc=0,this._oscState=1,this._oscOut=0,this._duty=0,this._prevOut=0,this.generate=this._generatePulse}(t.exports=a).prototype.reset=function(){this._oscPos=0,this._oscState=1,this._oscOut=0,this._prevOut=0},a.prototype.setStep=function(t,e){var n=t.pmin+(t.pmax-t.pmin-20)*e.pitch/93;switch(n=20+90*n/107,t.snap&&(n=Math.round(n)),this._oscInc=i.noteToFreq(n)/o,this._amp=e.volume/63,e.wave){case 0:this.generate=this._generatePulse,this._duty=.06;break;case 1:this.generate=this._generatePulse,this._duty=.12;break;case 2:this.generate=this._generatePulse,this._duty=.25;break;case 3:this.generate=this._generatePulse,this._duty=.5;break;case 4:this.generate=this._generateTriangle;break;case 5:this.generate=this._generateSine;break;case 6:this.generate=this._generateSaw,this._amp*=2;break;case 7:this.generate=this._generateNoise,this._oscInc=2.9*this._oscInc+.01}},a.prototype._generatePulse=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),i=this._oscPos>this._duty?this._amp:-this._amp,t[o]=i;this._prevOut=i},a.prototype._generateTriangle=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),i=s[~~(32*this._oscPos)]*this._amp,t[o]=i;this._prevOut=i},a.prototype._generateSine=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),i=Math.sin(this._oscPos*r)*this._amp,t[o]=i;this._prevOut=i},a.prototype._generateSaw=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++)this._oscPos+=this._oscInc,1<this._oscPos&&(this._oscPos=this._oscPos%1),i=(this._oscPos-.5)*this._amp,t[o]=i;this._prevOut=i},a.prototype._generateNoise=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++){if(this._oscPos+=this._oscInc,1<this._oscPos){this._oscPos=this._oscPos%1;var r=!(16384&this._oscState)^!(8192&this._oscState);this._oscState=32767&(this._oscState<<1|r),this._oscOut=(16384&this._oscState)>>14}i=(this._oscOut-.5)*this._amp,t[o]=i}this._prevOut=i},a.prototype.generateEndDamping=function(t,e,n){for(var i=this._prevOut,o=e;o<n;o++)i*=.98,t[o]=i}},function(t,e){for(var o=[],n=0;n<128;n++)o.push(440*Math.pow(2,(n-69)/12));e.noteToFreqTable=o,e.noteToFreq=function(t){t<0&&(t=0),127<t&&(t=127);var e=~~t,n=t-e,i=o[e];return i+n*(o[1+e]-i)}}],o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==r(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2);function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var n,i},"object"==(void 0===n?"undefined":r(n))&&"object"==(void 0===e?"undefined":r(e))?e.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==(void 0===n?"undefined":r(n))?n.bleeper=o():i.bleeper=o()},{}],15:[function(t,e,n){"use strict";e.exports=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}},{}],16:[function(t,e,n){"use strict";var c=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],i=!(!navigator||!navigator.getGamepads),p=!1,f=.2;function o(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}o.prototype._setupButtons=function(){for(var t=0;t<c.length;t++){var e=c[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var d=[new o,new o,new o,new o,window],r=new o;var s=i?function(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var n=t[e],i=d[e];if(n){var o,r,s,a;i.available=!0,p&&(o=i.btn.right,r=i.btn.left,a=i.btn.down,s=i.btn.up);for(var u=0;u<c.length;u++){var l=c[u],h=n.buttons[u].pressed;i.btnp[l]=!i.btn[l]&&h,i.btnr[l]=i.btn[l]&&!h,i.btn[l]=h}i.x=n.axes[0],i.y=n.axes[1],i.z=n.axes[2],i.w=n.axes[3],i.lt=n.buttons[6].value,i.rt=n.buttons[7].value,p&&(i.btn.right=i.btn.right||i.x>f,i.btn.left=i.btn.left||i.x<-f,i.btn.down=i.btn.down||i.y>f,i.btn.up=i.btn.up||i.y<-f,i.btnp.right=i.btn.right&&!o,i.btnp.left=i.btn.left&&!r,i.btnp.down=i.btn.down&&!a,i.btnp.up=i.btn.up&&!s,i.btnr.right=!i.btn.right&&o,i.btnr.left=!i.btn.left&&r,i.btnr.down=!i.btn.down&&a,i.btnr.up=!i.btn.up&&s)}else i.available=!1}return d}:function(){return d};n.mapAnalogStickToDpad=function(t){p=!0,f=void 0===t?.3:t},n.update=function(){window.gamepads=s(),window.gamepad=function(){for(var t=0;t<c.length;t++){var e=c[t];r.btnp[e]=btnp[e]||d[0].btnp[e]||d[1].btnp[e]||d[2].btnp[e]||d[3].btnp[e],r.btnr[e]=btnr[e]||d[0].btnr[e]||d[1].btnr[e]||d[2].btnr[e]||d[3].btnr[e],r.btn[e]=btn[e]||d[0].btn[e]||d[1].btn[e]||d[2].btn[e]||d[3].btn[e]}return r.btn.up&&r.btn.down&&(r.btn.down=!1),r.btn.right&&r.btn.left&&(r.btn.left=!1),r}()}},{}],17:[function(t,e,n){"use strict";e.exports={}},{}],18:[function(t,e,n){"use strict";e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],19:[function(t,e,n){"use strict";e.exports=t("./part7_persistency/main")},{"./part7_persistency/main":34}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("./Entity")),s=i(t("./game"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(r){return function(){var t,e,n,i=c(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,r["default"]);var t,e,n,i=h(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,8,8)).vx=0<t?1:-1,e}return t=o,(e=[{key:"update",value:function(){var t=s.default.player;this.collideWith(t)&&(0<t.vy?(this.kill(),t.vy=-3):t.kill()),this.resolveLevelCollision(s.default.level).front&&s.default.entityManager.removeEntity(this)}},{key:"render",value:function(){sprite(134,this.x,this.y,this.vx<0)}},{key:"kill",value:function(){s.default.entityManager.removeEntity(this),sfx("stomp")}}])&&u(t.prototype,e),n&&u(t,n),o}();n.default=o},{"./Entity":23,"./game":30}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("./Entity")),s=i(t("./Bullet")),a=i(t("./game"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(r){return function(){var t,e,n,i=p(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=p(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(o,r["default"]);var t,e,n,i=c(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,8,8)).timer=120,t}return t=o,(e=[{key:"update",value:function(){var t=a.default.player,e=Math.abs(t.x-this.x);8<e&&e<64&&0===this.timer&&this.fire(),--this.timer<0&&(this.timer=120)}},{key:"render",value:function(){}},{key:"fire",value:function(){var t=a.default.player.x-this.x,e=new s.default(t);e.x=this.x,e.y=this.y,a.default.entityManager.addEntity(e),sfx("cannon")}}])&&l(t.prototype,e),n&&l(t,n),o}();n.default=o},{"./Bullet":20,"./Entity":23,"./game":30}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("./Entity")),s=i(t("./game")),a=i(t("./state"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(r){return function(){var t,e,n,i=p(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=p(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==u(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=[160,161,162,163,164],o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(o,r["default"]);var t,e,n,i=c(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,8,8)).animFrame=0,e.tile=t,e}return t=o,(e=[{key:"update",value:function(){this.collideWith(s.default.player)&&this.collect()}},{key:"render",value:function(){this.animFrame=(this.animFrame+.2)%f.length,sprite(f[Math.floor(this.animFrame)],this.x,this.y)}},{key:"collect",value:function(){sfx("coin"),s.default.entityManager.removeEntity(this),a.default.removeEntity(s.default.level.id,this.tile)}}])&&l(t.prototype,e),n&&l(t,n),o}();n.default=o},{"./Entity":23,"./game":30,"./state":32}],23:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var f=settings.tileSize.width,d=settings.tileSize.height,i=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.w=t||f,this.h=e||d,this.x=0,this.y=0,this.vx=0,this.vy=0,this.onGround=!0,this._collisions={top:!1,bottom:!1,front:!1}}var t,e,i;return t=n,(e=[{key:"setPosition",value:function(t,e){this.x=t,this.y=e}},{key:"resolveLevelCollision",value:function(t){var e=this._collisions;e.top=!1,e.bottom=!1,e.front=!1;var n=this.x+this.vx,i=this.y+this.vy;if(0!==this.vx){var o=this.vx<0?0:this.w,r=t.getTileAt(n+o,this.y+1),s=t.getTileAt(n+o,this.y+this.h-1);(r.isSolid||s.isSolid)&&(n=Math.round((n+o)/f)*f-o,e.front=!0)}if(this.onGround){var a=t.getTileAt(n+1,i+this.h+1),u=t.getTileAt(n+this.w-2,i+this.h+1);a.isEmpty&&u.isEmpty&&(this.onGround=!1)}else if(0<this.vy){var l=t.getTileAt(n+1,i+this.h),h=t.getTileAt(n+this.w-2,i+this.h);(l.isSolid||h.isSolid)&&(i=Math.round(i/d)*d,e.bottom=!0)}else if(this.vy<0){var c=t.getTileAt(n+1,i),p=t.getTileAt(n+this.w-2,i);(c.isSolid||p.isSolid)&&(i=Math.round(i/d)*d,e.top=!0)}return this.x=n,this.y=i,e}},{key:"collideWith",value:function(t){return this.x<t.x+t.w&&this.y<t.y+t.h&&t.x<this.x+this.w&&t.y<this.y+this.h}}])&&o(t.prototype,e),i&&o(t,i),n}();n.default=i},{}],24:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=[]}var e,n,i;return e=t,(n=[{key:"reset",value:function(){this.entities.length=0}},{key:"addEntity",value:function(t){-1===this.entities.indexOf(t)&&this.entities.push(t)}},{key:"removeEntity",value:function(t){var e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)}},{key:"update",value:function(){for(var t=this.entities.length-1;0<=t;t--){var e=this.entities[t];e.update&&e.update()}}},{key:"render",value:function(){for(var t=this.entities.length-1;0<=t;t--){var e=this.entities[t];e.render&&e.render()}}}])&&o(e.prototype,n),i&&o(e,i),t}();n.default=i},{}],25:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=h(t("./game")),o=h(t("./Coin")),s=h(t("./Turtle")),a=h(t("./Cannon")),u=h(t("./state")),l=t("./doors");function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=settings.tileSize.width,d=settings.tileSize.height,y={isEmpty:!0},v={1:252,2:253,3:254,4:255},g=(p(i={0:{isSolid:!0},134:{isSolid:!0},76:{isEmpty:!0,isKill:!0}},v[1],{isEmpty:!0,isDoor:!0,door:1}),p(i,v[2],{isEmpty:!0,isDoor:!0,door:2}),p(i,v[3],{isEmpty:!0,isDoor:!0,door:3}),p(i,v[4],{isEmpty:!0,isDoor:!0,door:4}),i),m={160:o.default,135:s.default,134:a.default},_=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="",this.logic=null,this.background=null,this.width=0,this.height=0}var e,n,i;return e=t,(n=[{key:"loadLevel",value:function(t){this.id=t,this.logic=getMap("part7/".concat(t,"/logic")),this.background=getMap("part7/".concat(t,"/background")),this.width=this.logic.width*f,this.height=this.logic.height*d,r.default.entityManager.reset(),this.createEntities(this.logic)}},{key:"render",value:function(){draw(this.background||this.logic,0,0)}},{key:"reset",value:function(){this.loadLevel("level1");var t=this.logic.find(153);if(0===t.length)return console.error("No entry point defined"),void r.default.player.setPosition(0,0);var e=t[0];r.default.player.setPosition(e.x*f,e.y*d)}},{key:"goto",value:function(t,e){this.loadLevel(t);var n=this.logic.find(v[e])[0];r.default.player.setPosition(n.x*f,n.y*d)}},{key:"useDoor",value:function(t){var e=(0,l.getDestination)(this.id,t);this.goto(e.level,e.door)}},{key:"createEntities",value:function(i){function t(t){var e=i.find(~~t);if(!e.length)return"continue";var n=m[t];e.forEach(function(t){if(!u.default.isEntityRemoved(o.id,t)){var e=new n(t);e.x=t.x*f,e.y=t.y*d,r.default.entityManager.addEntity(e)}})}var o=this;for(var e in m)t(e)}},{key:"getTileAt",value:function(t,e){t=~~(t/f),e=~~(e/d),t=clamp(t,0,this.logic.width-1),e=clamp(e,0,this.logic.height-1);var n=this.logic.get(t,e);return n&&g[n.sprite]||y}}])&&c(e.prototype,n),i&&c(e,i),t}();n.default=_},{"./Cannon":21,"./Coin":22,"./Turtle":27,"./doors":29,"./game":30,"./state":32}],26:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("./Entity")),s=i(t("./constants")),a=i(t("./game")),u=i(t("../scenes"));function i(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(r){return function(){var t,e,n,i=f(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=f(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==l(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=[154,155,156],o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(o,r["default"]);var t,e,n,i=p(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,6,8)).jumping=!1,t.jumpCounter=0,t.facingLeft=!1,t.animFrame=0,t}return t=o,(e=[{key:"startJump",value:function(){this.onGround&&(this.onGround=!1,this.jumping=!0,this.jumpCounter=0,sfx("jump"))}},{key:"jump",value:function(){this.jumping&&(20<this.jumpCounter++&&(this.jumping=!1),this.vy=-s.default.JUMP_ACCELERATION+.08*this.jumpCounter)}},{key:"endJump",value:function(){this.jumping=!1}},{key:"land",value:function(){this.onGround=!0,this.jumping=!1,this.vy=0,sfx("land")}},{key:"kill",value:function(){u.default.open("over")}},{key:"getActiveTile",value:function(){return a.default.level.getTileAt(this.x+3,this.y+4)}},{key:"updatePosition",value:function(){this.vx*=s.default.FRICTION,this.onGround||(this.vy+=s.default.GRAVITY,this.vy=Math.min(this.vy,s.default.MAX_GRAVITY));var t=this.resolveLevelCollision(a.default.level);t.front&&(this.vx=0),t.bottom&&this.land(),t.top&&this.endJump()}},{key:"update",value:function(){btn.right&&(this.vx+=s.default.WALK_ACCELERATION,this.facingLeft=!1),btn.left&&(this.vx-=s.default.WALK_ACCELERATION,this.facingLeft=!0),this.vx=clamp(this.vx,-s.default.MAX_SPEED,s.default.MAX_SPEED),btnp.A&&this.startJump(),btnr.A&&this.endJump(),btn.A&&this.jump(),this.updatePosition();var t=this.getActiveTile();t.isKill&&this.kill(),this.y>a.default.level.height+20&&(sfx("pitfall"),this.kill()),btnp.up&&t.isDoor&&(a.default.level.useDoor(t.door),sfx("door"))}},{key:"render",value:function(){var t=this.x-1,e=this.y;if(this.onGround)if(btn.right||btn.left){this.animFrame=this.animFrame+.2,this.animFrame>d.length&&(sfx("footsteps"),this.animFrame=this.animFrame%d.length);var n=Math.floor(this.animFrame);sprite(d[n],t,e,this.facingLeft)}else sprite(153,t,e,this.facingLeft);else sprite(this.vy<0?154:155,t,e,this.facingLeft)}}])&&h(t.prototype,e),n&&h(t,n),o}();n.default=o},{"../scenes":36,"./Entity":23,"./constants":28,"./game":30}],27:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("./Entity")),s=i(t("./game"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(r){return function(){var t,e,n,i=c(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=[135,136],o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,r["default"]);var t,e,n,i=h(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,8,8)).animFrame=0,e.vx=t.flipH?-.2:.2,e}return t=o,(e=[{key:"update",value:function(){var t=this.vx<0?-1:this.w+1;s.default.level.getTileAt(this.x+t,this.y+this.h+4).isEmpty&&(this.vx*=-1),this.resolveLevelCollision(s.default.level).front&&(this.vx*=-1);var e=s.default.player;this.collideWith(e)&&(0<e.vy?(this.kill(),e.vy=-3):e.kill())}},{key:"render",value:function(){this.animFrame=(this.animFrame+.1)%p.length,sprite(p[Math.floor(this.animFrame)],this.x,this.y,this.vx<0)}},{key:"kill",value:function(){s.default.entityManager.removeEntity(this),sfx("stomp")}}])&&u(t.prototype,e),n&&u(t,n),o}();n.default=o},{"./Entity":23,"./game":30}],28:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={GRAVITY:.3,MAX_GRAVITY:2,MAX_SPEED:1,WALK_ACCELERATION:.1,JUMP_ACCELERATION:2,JUMP_DURATION:20,FRICTION:.9,GROUND_LEVEL:104}},{}],29:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getDestination=function(t,e){return o[t][e]};var o={};function i(t,e,n,i){o[t]||(o[t]={}),o[n]||(o[n]={}),o[t][e]={level:n,door:i},o[n][i]={level:t,door:e}}i("level1",1,"level2",1),i("level2",2,"level3",1),i("level3",2,"level2",3),i("level2",4,"level1",2),i("level3",3,"level4",1)},{}],30:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=settings.screen.width,o=settings.screen.height,r={level:null,player:null,entityManager:null,update:function(){this.player.update(),this.entityManager.update(),cls(),camera(clamp(this.player.x-64,0,this.level.width-i),clamp(this.player.y-64,0,this.level.height-o)),this.level.render(),this.entityManager.render(),this.player.render()}};n.default=r},{}],31:[function(t,e,n){"use strict";var i=a(t("./Player")),o=a(t("./Level")),r=a(t("./game")),s=a(t("./EntityManager"));function a(t){return t&&t.__esModule?t:{default:t}}r.default.level=new o.default,r.default.player=new i.default,r.default.entityManager=new s.default,n.open=function(){paper(15),r.default.level.reset()},n.update=function(){r.default.update()}},{"./EntityManager":24,"./Level":25,"./Player":26,"./game":30}],32:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={level:0,door:1,death:0,removedEntities:{},reset:function(){this.level=0,this.door=1,this.deat=0,this.removedEntities={}},setCheckpoint:function(t,e){this.level=t,this.door=e},getEntityId:function(t,e){return"".concat(t,":").concat(e.x,":").concat(e.y)},removeEntity:function(t,e){this.removedEntities[this.getEntityId(t,e)]=!0},isEntityRemoved:function(t,e){return!!this.removedEntities[this.getEntityId(t,e)]}}},{}],33:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../scenes"))&&i.__esModule?i:{default:i};var r={open:function(){paper(0).cls(),locate(5,7).pen(1).print("SUPER PLATFORMER GAME"),locate(4,19).pen(11).print("PRESS `ACTION` to START")},update:function(){btnp.A&&o.default.open("game")}};n.default=r},{"../scenes":36}],34:[function(t,e,n){"use strict";var i,o=(i=t("./scenes"))&&i.__esModule?i:{default:i};o.default.open("intro"),n.update=function(){o.default.update()}},{"./scenes":36}],35:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../scenes"))&&i.__esModule?i:{default:i};var r={open:function(){setTimeout(function(){paper(0).cls(),locate(11,9).pen(9).print("GAME OVER"),locate(4,19).pen(11).print("PRESS `ACTION` to RETRY")},0)},update:function(){btnp.A&&o.default.open("game")}};n.default=r},{"../scenes":36}],36:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("./intro")),o=s(t("./game")),r=s(t("./over"));function s(t){return t&&t.__esModule?t:{default:t}}var a={scenes:{intro:i.default,game:o.default,over:r.default},update:null,activeScene:null,open:function(t){var e=this.scenes[t];if(!e)return console.error("Scene does not exist",t);this.activeScene=e,this.update=e.update;for(var n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];e.open&&e.open.apply(e,i)}};n.default=a},{"./game":31,"./intro":33,"./over":35}],37:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],38:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],39:[function(t,e,f){var a=/%[sdj%]/g;f.format=function(t){if(!x(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,r=String(t).replace(a,function(t){if("%%"===t)return"%";if(o<=n)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),s=i[n];n<o;s=i[++n])_(s)||!l(s)?r+=" "+s:r+=" "+u(s);return r},f.deprecate=function(t,e){if(w(global.process))return function(){return f.deprecate(t,e).apply(this,arguments)};if(!0===process.noDeprecation)return t;var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}};var i,o={};function u(t,e){var n={seen:[],stylize:s};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&f._extend(n,e),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=r),d(n,t,n.depth)}function r(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function s(t,e){return t}function d(e,n,i){if(e.customInspect&&n&&M(n.inspect)&&n.inspect!==f.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(i,e);return x(t)||(t=d(e,t,i)),t}var o=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(x(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(m(e))return t.stylize(""+e,"boolean");if(_(e))return t.stylize("null","null")}(e,n);if(o)return o;var r,s=Object.keys(n),a=(r={},s.forEach(function(t,e){r[t]=!0}),r);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),P(n)&&(0<=s.indexOf("message")||0<=s.indexOf("description")))return y(n);if(0===s.length){if(M(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(S(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(P(n))return y(n)}var l,h="",c=!1,p=["{","}"];g(n)&&(c=!0,p=["[","]"]),M(n)&&(h=" [Function"+(n.name?": "+n.name:"")+"]");return S(n)&&(h=" "+RegExp.prototype.toString.call(n)),E(n)&&(h=" "+Date.prototype.toUTCString.call(n)),P(n)&&(h=" "+y(n)),0!==s.length||c&&0!=n.length?i<0?S(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=c?function(e,n,i,o,t){for(var r=[],s=0,a=n.length;s<a;++s)C(n,String(s))?r.push(v(e,n,i,o,String(s),!0)):r.push("");return t.forEach(function(t){t.match(/^\d+$/)||r.push(v(e,n,i,o,t,!0))}),r}(e,n,i,a,s):s.map(function(t){return v(e,n,i,a,t,c)}),e.seen.pop(),function(t,e,n){if(60<t.reduce(function(t,e){return 0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(l,h,p)):p[0]+h+p[1]}function y(t){return"["+Error.prototype.toString.call(t)+"]"}function v(t,e,n,i,o,r){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),C(i,o)||(s="["+o+"]"),a||(t.seen.indexOf(u.value)<0?-1<(a=_(n)?d(t,u.value,null):d(t,u.value,n-1)).indexOf("\n")&&(a=r?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),w(s)){if(r&&o.match(/^\d+$/))return a;s=(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(s,"string"))}return s+": "+a}function g(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function _(t){return null===t}function b(t){return"number"==typeof t}function x(t){return"string"==typeof t}function w(t){return void 0===t}function S(t){return l(t)&&"[object RegExp]"===n(t)}function l(t){return"object"==typeof t&&null!==t}function E(t){return l(t)&&"[object Date]"===n(t)}function P(t){return l(t)&&("[object Error]"===n(t)||t instanceof Error)}function M(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function h(t){return t<10?"0"+t.toString(10):t.toString(10)}f.debuglog=function(e){if(w(i)&&(i=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=process.pid;o[e]=function(){var t=f.format.apply(f,arguments);console.error("%s %d: %s",e,n,t)}}else o[e]=function(){};return o[e]},(f.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},f.isArray=g,f.isBoolean=m,f.isNull=_,f.isNullOrUndefined=function(t){return null==t},f.isNumber=b,f.isString=x,f.isSymbol=function(t){return"symbol"==typeof t},f.isUndefined=w,f.isRegExp=S,f.isObject=l,f.isDate=E,f.isError=P,f.isFunction=M,f.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},f.isBuffer=t("./support/isBuffer");var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}f.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[h(t.getHours()),h(t.getMinutes()),h(t.getSeconds())].join(":"),[t.getDate(),c[t.getMonth()],e].join(" ")),f.format.apply(f,arguments))},f.inherits=t("inherits"),f._extend=function(t,e){if(!e||!l(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}},{"./support/isBuffer":38,inherits:37}],40:[function(d,t,e){"use strict";var n,i,c=d("."),o={dat:{palette:null,tilesheet:null,bleeper:{_type:"Bleeper program",v:1,s:[{n:"jump",i:[18,24,88,0],s:"%;2%C6%I:%M<%Q>%T<%W:%[5%^0%_,%_'%_%"},{n:"footsteps",i:[9,6,40,0],s:"*Z7*H-#k##k##k##k##N#*G8*@+#N##N##N##N#*##*Q8*<-"},{n:"land",i:[26,56,108,0],s:"*C&*T~*7(*Z$"},{n:"pitfall",i:[39,56,95,0],s:"(j0(s8(mG(gU(aX(X[(S^(M_(G^(BZ(?V(;P(8I(5A(3:(14(/2(~0(,-(**())(('(($('%('$(%$"},{n:"coin",i:[13,61,101,1],s:"&#b&#X&#K&#G&#F&#E&#C~$a~$a~$Z~$T~$O~$J~$E~$A~$>~$<~$:~$7~$5~$2~$/~$-~$+~$)~$'~$&~$%~$%~$%~$$~$$"},{n:"stomp",i:[15,19,93,0],s:"&(S&(T&+T&~T#0Q&<U&=I&?E&B=&F6&J-&`>&gF&jJ&mQ"},{n:"cannon",i:[20,16,74,0],s:"'$2'%P'%F'(?'*U'##'!#')-&F9&E0'Ea'E`'C['@Q'>E';<'66'3*"},{n:"door",i:[18,8,72,0],s:"#*F#-K#1O#6P#;U#@U#DU#HU#N[#O_#O##O##O##O##O##MU#LU#IU#EU#@U#<U#9U#6T#2O#/N#,I#*G"}]},maps:{_type:"maps",maps:[{w:16,h:16,name:"part1/ground",sheet:"",data:"!!.P##|J"},{w:16,h:16,name:"part2/level",sheet:"",data:"!!.P##|J"},{w:16,h:16,name:"part3/level",sheet:"",data:"##|;!!|8##|,!!|8##|,!!|8##|,!!|8##|,!!|8##|,!!|8##|,!!|~##!!|3##|~!!|-##|,!!|0##|-!!|,##!!|~##!!|0##|,!!|3##|,!!|-##|,!!|~##|,!!|1##|~!!|5##|0!!|3##|2!!|,##|D"},{w:64,h:24,name:"part4/logic",sheet:"tilesheet",data:"!!!.!!|M##|-!!|e##!!|i##|-!!|g##|2!!|}##!!|X##|-!!|8##!!|j##!!|M##|4!!|<##|,!!|i##|,!!|I##|,!!|G##|,!!|E##|4!!|C##|,!!|i##|,!!|8##|/!!|0##!!|I##|1!!|8##|/!!|-##|~!!|<##|]!!|5##}d"},{w:64,h:24,name:"part4/background",sheet:"",data:"!!!.!!|M#/|-!!|e#^!!|-#@!!|e#^|-!!|,#@!!|d#/|2!!|d#@!!|~#@!!|=#3!!|:#)#*#+!!|=#@!!|~#@!!|,#8|-!!|8#C!!|9#)#9#:#;#+!!|<#P!!|~#@!!|=#C!!|9#9#:#J|,#;!!|9#/|4!!|<#C#5!!|8#I#J|-#K!!|:#@!!|0#@!!|1#)#*#+!!|3#C#E!!|/#)#*#+!!|0#Y#Z|-#[!!|6#^|,!!|,#@!!|0#@!!|1#9#:#;!!|3#C#E!!|/#9#:#;!!|2#k!!|4#/|4!!|/#@!!|1#I#J#K!!|3#C#E!!|/#I#J#K!!|0&V#j#k#m!!|5#@!!|/#@!!|0#@!!|1#Y#Z#[!!|/#n#j#l!!#C#E!!|/#Y#Z#[!!|0#3#4|-#5!!|~#n#j#8!!|-#@!!|/#@!!|0#@!!|,#o|~!!|,#k#l!!#n#j!!#7|0#E#o|,!!#m!!#j#k#l!!|-&U#o|,#C#D|-#E!!#j!!#7|~#m!!|,#P!!|/#@!!|0#P!!#7|7#G|0#7|A#G|~#7|~!!|,#l!!#j#P!!|-#j!!#7|-#G|9# #G|L#7|5#G}#"},{w:64,h:24,name:"part5/logic",sheet:"",data:"!!!.!!|M##|-!!|e##!!|i##|-!!|g##|2!!|m#p!!|9##!!|X##|-!!|8##!!|j##!!|M##|4!!|<##|,!!|I#p!!|H##|,!!|I##|,!!|G##|,!!|E##|4!!|C##|,!!|i##|,!!|8##|/!!|0##!!|I##|1!!$`!!|6##|/!!|-##|~!!|<##|F!!|-##|=!!|5##|I!!|-##|?!!|-##!!|-##|K!!|-##|?!!|-##!!|-##|B"},{w:64,h:24,name:"part5/background",sheet:"",data:"!!!.!!|M#/|-!!|e#^!!|-#@!!|e#^|-!!|,#@!!|d#/|2!!|d#@!!|~#@!!|-#p!!|9#3!!|:#)#*#+!!|=#@!!|~#@!!|,#8|-!!|8#C!!|9#)#9#:#;#+!!|<#P!!|~#@!!|=#C!!|9#9#:#J|,#;!!|9#/|4!!|<#C#5!!|8#I#J|-#K!!|6#p!!|-#@!!|0#@!!|1#)#*#+!!|3#C#E!!|/#)#*#+!!|0#Y#Z|-#[!!|6#^|,!!|,#@!!|0#@!!|1#9#:#;!!|3#C#E!!|/#9#:#;!!|2#k!!|4#/|4!!|/#@!!|1#I#J#K!!|3#C#E!!|/#I#J#K!!|0&V#j#k#m!!|5#@!!|/#@!!|0#@!!|1#Y#Z#[!!|/#n#j#l!!#C#E!!|/#Y#Z#[!!|0#3#4|-#5!!|~#n#j#8!!|-#@!!|/#@!!|0#@!!|,#o|~!!|,#k#l!!#n#j!!#7|0#E#o|,!!#m!!#j#k#l!!|-&U#o|,#C#D|-#E!!#j!!#7|~#m!!|,#P!!|/#@!!|0#P!!#7|7#G|0#7|3!!|-#7|5#G|~#7|~!!|/#P!!|-#j!!#7|-#G|9# #G|6!!|-#G|=#7|,!!|-#7!!|-#7|,#G|I!!|-#G|?!!|-#G!!|-#G|B"},{w:64,h:24,name:"part6/logic",sheet:"tilesheet",data:"!! =$g|-!!|h$g|-!!}J##|-!!|e##!!|i##|-!!|g##|2!!|m#p!!|9##!!|M$g|-!!|-$g!!|~##|-!!|8##!!|T'6!!|>##!!|B$g|-!!|2##|4!!|<##|,!!|A$g|-!!|/#p!!|H##|,!!|A$g|-!!|,$M!!|,##|,!!|G##|,!!|E##|4!!|C##|,!!$g|-!!|2$g!!|,$M!!|Q'5!!|0##|,!!|8##|/!!$g|,!!|-##!!|0$g|-!!$g|-!!|4##!!|/##!!##|1!!$`!!|6##|/!!|-##|~!!|/$g!!|-$g!!|-$g!!|~##|F!!|-##|=!!|5##|I!!|-##|?!!|-##!!|-##|K!!|-##|?!!|-##!!|-##|B"},{w:64,h:24,name:"part6/background",sheet:"tilesheet",data:"!!!.!!|M#/|-!!|e#^!!|-#@!!|e#^|-!!|,#@!!|d#/|2!!|d#@!!|~#@!!|-#p!!|9#3!!|:#)#*#+!!|=#@!!|~#@!!|,#8|-!!|8#C!!|9#)#9#:#;#+!!|<#P!!|~#@!!|=#C!!|9#9#:#J|,#;!!|9#/|4!!|<#C#5!!|8#I#J|-#K!!|6#p!!|-#@!!|0#@!!|1#)#*#+!!|3#C#E!!|/#)#*#+!!|0#Y#Z|-#[!!|6#^|,!!|,#@!!|0#@!!|1#9#:#;!!|3#C#E!!|/#9#:#;!!|2#k!!|4#/|4!!|/#@!!|1#I#J#K!!|3#C#E!!|/#I#J#K!!|0&V#j#k#m!!|5#@!!|/#@!!|0#@!!|1#Y#Z#[!!|,%5!!|,#n#j#l!!#C#E!!|/#Y#Z#[!!|0#3#4|-#5!!|~#n#j#8!!|-#@!!|/#@!!|0#@!!|,#o|~##!!#k#l!!|,%E!!#7|0#E#o|,!!#m!!#j#k#l!!|-&U#o|,#C#D|-#E!!#j!!#7|~#m!!|,#P!!|/#@!!|0#P!!#7|7#G|0#7|3!!|-#7|5#G|~#7|~!!|/#P!!|-#j!!#7|-#G|9# #G|6!!|-#G|=#7|,!!|-#7!!|-#7|,#G|I!!|-#G|?!!|-#G!!|-#G|B"},{w:16,h:16,name:"part7/level1/logic",sheet:"tilesheet",data:"!!|k##|~!!|3##|1!!|~$g|~!!##|1!!|~$g|~!!##|1!!|0%g!!|,##|1!!|~##|~!!##|1!!|3##|1!!|3##|1!!$`!!|-%f!!|-##|n"},{w:36,h:20,name:"part7/level2/logic",sheet:"",data:"!!.x%i!!|L##|~!!|-##|~!!|8##!!|@##|,!!|~%h!!|0##!!|E##|-!!|/##|,!!|L##|,!!|G$g|-!!|,##|,!!|L##|,!!|E%g!!|,$M!!|-##|,!!|3$g|-!!|2$L!!|/##|0!!|,##|,!!|3$g|-!!|2##!!|7##|,!!|,%f!!|~$M!!|/##|-!!|,##|~!!|~$g|0!!$L##|<!!|,##|;!!|N"},{w:16,h:16,name:"part7/level1/background",sheet:"",data:"!!|A%*'q!!|7%*%J(#!!|2#l#n!!|,3#%J|-5j!!|~#j!!#4|-#5!!|,*Y5k-B!!|~#3#4|,#D|-#E!!|3#C#D|/#E!!|3#C#D|/#E!!|~#l!!$]!!|,#C#D|/#E!!|~#/|~!!#C#D|/#E!!|~#@!!|,#@!!#C#D|/#E!!|~#@!!|,#@!!#C#D|/#E!!|~#P$]!!#P!!#C#D|,#7|:#G|Z"},{w:36,h:20,name:"part7/level2/background",sheet:"",data:"!!}+%*'q!!|K%*%J|,0;'q!!|8%*'q!!|83#%J|~5k0:!!|0%*'q!!|~%*%J|,'q!!|8*Y5k|,-B!!|/%*0;|,%J-B!!|-%*%J|~0;0:!!|>3#%J|--B!!|~*Y%J|,5k|,-B!!|-$]!!|<*Y5k-B!!|0*Y-B!!|/#/|~!!|-#/|~!!|8#3!!|@#/|,!!|~$]!!|0#C!!|E#/|-!!|/#C#5!!|8%*'q!!|4#@!!#@!!|/#C#E!!|63#0;%J|,0:!!|3#@!!#@!!|/#C#E!!|/#)#*#+!!|/*Y5k-B!!|4#@!!#@!!|/#C#E!!|/#9#:#;!!|<#@$]#P!!|/#C#E!!|/#I#J#K!!|6%5!!|/#/|0!!|,#C#E!!|/#Y#Z#[!!|0#j!!|/%E!!|/#@!!|~#@!!|,#C#E!!|,$]!!|,#m#k#l#o|-#n!!#7|-!!|,#7|~!!#o|,!!#P!!#j!!|,#P!!%5#C#7|8#G|-!!|,#G|~#7|7#G|;!!|,#G|;"},{w:20,h:28,name:"part7/level3/logic",sheet:"tilesheet",data:"!!|V$g!!|>$g|,!!|;$g!!|@%g!!|:##|/!!|/$g|,!!|3##|,!!|~##|,!!$g|,!!|P##|,!!|8$M!!|,##|-!!|0$g|,!!|/##|-!!|4$g|,!!##|,!!|-##|,!!|H##|,!!|<##|-!!|4$g|,!!|1##!!|,##|,!!|0$g|,!!|8##|,!!|-%h!!|<##|,!!|2$g|-!!|,$M!!|-##|-!!|7##|-!!|6##|-!!|E$g!!|2$g|,!!|,##|-!!|7$g|,##|0!!%f!!##!!|2##|6!!|2##|6!!|2##|6!!|~"},{w:20,h:28,name:"part7/level3/background",sheet:"tilesheet",data:"!!|B#)#*#+!!|2%*'q!!|1#9#:#;!!|0%*0;%J|,'q!!|0#I#J#K!!|0*Y%J|--B!!|0#Y#Z#[!!|1*Y5k-B!!|1#m#k#l$]!!|:#7|/!!|9#V#G|,&?#W!!|,#/|,!!|6#0#W!!|~#@!!|,#j!!|4#@!!|/#@!!|,#7|,!!|3#@!!|~#n#@!!#7#G&?!!|3#@!!|-#7|-!!#W|,!!|4#/|,!!|,#V#G|,!!|4#m#l!!|0#W#@!!|4#7|,!!|1#@!!|4#V#G#7!!|0#@!!|5#V#G!!|,#/|,!!|,#@!!|6#W!!|,#@!!|-#/|,!!|,#n$]!!|4#@!!|-#@!!|,#j#7|,!!|4#@!!|-#@!!|,#7#G&?!!|4#@!!|,#/|-!!#W|,!!|3#/|-!!|-#@!!|8#@!!|,#m!!#@!!|8#P#j#3#4#5#P!!|-#l!!|,%*0;!!|~#l!!#3#4#D|-#5!!$]!!#6!!%*%J|,'q!!|-#3#4#D|0#4|-#E!!%:%J|,(#!!%*0;#7|6%*%J|~0;%J|,#G|6%J|~"},{w:26,h:16,name:"part7/level4/logic",sheet:"",data:"!!}v$g|-!!|,$g|0!!|0$g!!|~$g|,!!|,$g|-!!|,$g|0!!|/$g!!$g!!|,$g!!|,$g!!|4$g|,!!|0%f!!|/#p!!|,##|-!!|,##|~!!|1##|-!!|,##|~!!##|-!!|,##|0!!|/##|-!!|,##|~!!##|,!!|~##|/!!}8"},{w:26,h:16,name:"part7/level4/background",sheet:"",data:"!!|U#)#*|-#+!!|>#)#9#:|-#;#+!!|=#9#J|/#;!!|=#I#J|/#K!!|=#I#J|/#K!!|=#Y#Z|/#[!!|@#k!!|<#m#n&U!!|,&U#m#k#m!!|1#m$]&U!!|,#n!!#p!!|,#7|-!!|,#7|~#m#n!!|/#7|-!!|,#7|~!!#G|,&?!!|,#G|~#7|,!!|/#V#G&?!!|,#V#G|,&?!!#V#G!!|-#W#V#G|-&?!!|0#W!!|~#W|,!!|-#W!!|0#W!!|/%*0+!!|3%*'q!!|~%*'q!!|/%*'q0K|,0+%*0;|,'q!!|-%*0K|,'q!!%*0;0K|,'q!!|-%*0K|30;'q%*0K|~0;0K|/'q%*0;0K|-"}],emptyDir:[]}},root:"assets/",img:["palette.png","tilesheet.png"],snd:[],settings:{name:"PlatformerTutorial",version:"2.0.2",appid:"XeGjghswqoFbiEa4",screen:{fullscreen:!0,resizable:!0,keepAspectRatio:!0,width:128,height:128,pixelSize:{width:4,height:4}},tileSize:{width:8,height:8},palette:{name:"db16",file:"palette",colors:["#140c1c","#deeed6","#d2aa99","#346524","#4e4a4e","#757161","#8595a1","#6daa2c","#854c30","#d04648","#d27d2c","#dad45e","#442434","#30346d","#597dce","#6dc2ca"]},controls:{up:38,down:40,left:37,right:39,A:32,B:88},touchEvent:{multiTouch:!1,disableContextMenu:!0,hideMousePointer:!1},gamepad:{analogToDpad:!0,deadZone:.5},loader:{colors:["#140C1C","#DEEED6"],custom:""}}},y=c.settings=o.settings,r=d("./assetLoader");function s(){n.resume(),document.body.removeEventListener("mousedown",s),document.body.removeEventListener("touchstart",s)}c.inherits=d("./inherits"),c.setFullScreen=function(){},n=null,i=window.AudioContext||window.webkitAudioContext,window.AudioContext=window.webkitAudioContext=function(){return n||(n=new i,document.body.addEventListener("mousedown",s),document.body.addEventListener("touchstart",s),n)};var a=d("audio-manager"),u=c.audioManager=new a(["sfx"]);u.settings.audioPath="audio/",u.settings.defaultFade=.3,u.init(),u.setVolume("sfx",1),c.sfx=function(t,e,n,i){u.playSound("sfx",t,e,n,i)},c.music=function(t,e,n,i){t?u.playLoopSound("sfx",t,e,0,0,n,i):u.stopLoopSound("sfx")};var l=c.btn={},h=c.btnp={},p=c.btnr={},f={},v=[],g=0;function m(){for(var t=0;t<g;t++)h[v[t]]=!1,p[v[t]]=!1}function _(t,e){var n=f[t];n&&(e&&!l[n]&&(h[n]=!0),!e&&l[n]&&(p[n]=!0),l[n]=e)}!function(){var t=y.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t)f[t[e]]=e,l[e]=!1,h[e]=!1,p[e]=!1,v.push(e);g=v.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),t.repeat||_(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),_(t.keyCode,!1)}),c.chr$=function(t){return String.fromCharCode(t)},c.clamp=function(t,e,n){return Math.max(e,Math.min(n,t))},c.random=function(t,e){return void 0===e?~~(t*Math.random()):~~(t+Math.random()*(e-t))};var b=d("./Texture"),x=d("./TileMap");d("./Texture/canvas2D"),d("./Texture/textCanvas2D");var w=y.tileSize.width,S=y.tileSize.height;b.setTileSize(w,S),x.setTileSize(w,S),c.texture=function(t){var e=new b(t.width,t.height);return e.clear().draw(t,0,0),e},c.tilesheet=function(t){return b.prototype.setGlobalTilesheet(t)};var E=function(){var t=y.screen,u=t.width,l=t.height,h=t.pixelSize,e=c.$screen=new b(u,l),n=e.canvas,i=n.style;if(document.body.appendChild(n),t.fullscreen)if(t.keepAspectRatio){var o=function(){var t=window.innerWidth,e=window.innerHeight,n=u*h.width,i=l*h.height,o=Math.min(t/n,e/i),r=n*o,s=i*o,a=c.$screen.canvas.style;a.width=r+"px",a.height=s+"px",a.left=(t-r)/2+"px",a.top=(e-s)/2+"px"};addEventListener("resize",o),o()}else i.width=i.height="100%";else i.width=u*h.width+"px",i.height=l*h.height+"px";return e}();c.cls=function(){return E.cls()},c.sprite=function(t,e,n,i,o,r){return E.sprite(t,e,n,i,o,r)},c.draw=function(t,e,n,i,o,r){return E.draw(t,e,n,i,o,r)},c.rect=function(t,e,n,i){return E.rect(t,e,n,i)},c.rectf=function(t,e,n,i){return E.rectf(t,e,n,i)},c.camera=function(t,e){return E.setCamera(t,e)},c.pen=function(t){return E.pen(t)},c.paper=function(t){return E.paper(t)},c.locate=function(t,e){return E.locate(t,e)},c.print=function(t,e,n){return E.print(t,e,n)},c.println=function(t){return E.println(t)},c.getMap=x.getMap,c.rectfill=c.rectf,E.canvas.addEventListener("contextmenu",function(t){return t.preventDefault(),!1});var P=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1/60)};window.frameId=0;var M=~~(y.screen.width/2),C=~~(y.screen.width/4),j=~~(y.screen.height/2);var T=["#000","#FFF"],k=y.loader&&y.loader.colors||y.loaderColors||T;Array.isArray(k)||(k=T);var A=d("./Color");E.setPalette([(new A).fromString(k[0]),(new A).fromString(k[1])]),E.paper(0).cls().paper(1).pen(1).rect(M-C-2,j-4,2*C+4,8),r.preloadStaticAssets(o,function(t,f){if(E.paper(0).pen(1).cls(),t)return console.error(t),void print(t);for(var e in c.assets=f,c)window[e]=c[e];var n=c.bleeper=d("./bleeper");window.bleeper=n,f.bleeper&&n.loadProgram(f.bleeper),function(){var t=d("./Color"),e=y.palette;if(e.file){for(var n=e.file.split("/"),i=f;i&&n.length;)i=i[n.shift()];if(!i)return;var o=i.width,r=i.height,s=i.x||0,a=i.y||0;i._isSprite&&(i=i.img);var u=d("./domUtils/createCanvas")(o,r).getContext("2d");u.drawImage(i,s,a,o,r,0,0,o,r);for(var l=u.getImageData(0,0,o,r).data,h=[],c=0;c<l.length;c+=4)l[c+3]<=1||h.push((new t).fromPixel(l,c));E.setPalette(h)}else{var p;for(p=e.colors?e.colors:e,h=[],c=0;c<p.length;c++)h.push((new t).fromString(p[c]));E.setPalette(h)}}(),f.tilesheet&&c.tilesheet(f.tilesheet),x.loadBank(f.maps);var i=d("./gamepad"),o=y.gamepad||{};o.analogToDpad&&i.mapAnalogStickToDpad(o.deadZone);var r=d("../../src/main.js");r.update&&(m(),function t(){window.frameId+=1,i.update(),r.update(),m(),P(t)}())},function(t,e,n,i){E.rect(M-C-2,j-4,2*C+4,8).rectf(M-C,j-2,~~(i*C*2),4)})},{".":17,"../../src/main.js":19,"./Color":8,"./Texture":10,"./Texture/canvas2D":9,"./Texture/textCanvas2D":11,"./TileMap":12,"./assetLoader":13,"./bleeper":14,"./domUtils/createCanvas":15,"./gamepad":16,"./inherits":18,"audio-manager":2}]},{},[40]);